<!DOCTYPE html>
<html>
<head><title>Test Finale</title></head>
<body>
    <h1>Test Connessione Fogli</h1>
    <div id="result"></div>
    
    <script>
        const sheets = {
            articoli: "https://docs.google.com/spreadsheets/d/e/2PACX-1vSujCY6DDQ2WDcJ8OfRQcJqUP7T_obac8KMCe7Oi4k14zzrj9zV5lwhryLvb7q8KqLRWxI2C4iIwtf-/pub?gid=0&single=true&output=csv",
            categorie: "https://docs.google.com/spreadsheets/d/e/2PACX-1vQIcNtVhlDB951QxufPk581mgRZUByqXColhlHBEF_csJbeUAJ98Lzv3tnlMn_Q-AiuQCvRv403UPLQ/pub?gid=0&single=true&output=csv",
            autori: "https://docs.google.com/spreadsheets/d/e/2PACX-1vTuJdqm3iA2sGWaMLmhPly5ltn8qoABw7hY2SfEw_JMHtBulSWdK0mrzhnY4d6LjH8V1aoblfSc2e0Q/pub?gid=0&single=true&output=csv"
        };

        async function testSheet(name, url) {
            try {
                const response = await fetch(url);
                const text = await response.text();
                const lines = text.split('\n');
                
                return {
                    name,
                    success: true,
                    lines: lines.length,
                    firstLine: lines[0],
                    sample: lines.slice(0, 3).join('<br>')
                };
            } catch (error) {
                return { name, success: false, error: error.message };
            }
        }

        async function runTests() {
            const results = await Promise.all(
                Object.entries(sheets).map(([name, url]) => testSheet(name, url))
            );
            
            let html = '<ul>';
            results.forEach(result => {
                html += `<li><h3>${result.name}</h3>`;
                if (result.success) {
                    html += `<p>✅ <strong>${result.lines} righe</strong></p>`;
                    html += `<p><small>${result.sample}</small></p>`;
                } else {
                    html += `<p>❌ Errore: ${result.error}</p>`;
                }
                html += '</li>';
            });
            html += '</ul>';
            
            document.getElementById('result').innerHTML = html;
        }
        
        runTests();
    </script>
</body>
</html>
